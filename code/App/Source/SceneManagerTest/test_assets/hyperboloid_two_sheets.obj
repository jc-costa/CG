# ============================================================================
# HYPERBOLOID OF TWO SHEETS - Quadric Surface Test
# ============================================================================
#
# DESCRIPTION:
#   The hyperboloid of two sheets consists of two separate bowl-shaped
#   surfaces (called "nappes") that open away from each other. Unlike the
#   one-sheet version, this surface is NOT connected.
#
# QUADRIC CLASSIFICATION:
#   Type: Hyperboloid of Two Sheets (central quadric)
#   Topology: TWO DISCONNECTED surfaces (upper and lower nappes)
#   Gaussian Curvature: Positive (K > 0) everywhere
#   Note: NOT a ruled surface (no straight lines on surface)
#
# MATHEMATICAL DEFINITION:
#   Implicit form:    -(x/a)² - (y/b)² + (z/c)² = 1
#   Standard form:    z²/c² - x²/a² - y²/b² = 1
#   Rearranged:       z² = c²(1 + x²/a² + y²/b²)
#                     |z| ≥ c (surface exists only for |z| ≥ c)
#
#   Parametric form (upper sheet):
#                     x = a·sinh(v)·cos(u)
#                     y = b·sinh(v)·sin(u)
#                     z = c·cosh(v)
#   Where: u ∈ [0, 2π], v ∈ [0, ∞)
#
# QUADRIC COEFFICIENTS (For -x² - y² + z² = 1):
#   A = B = -1
#   C = 1 (positive coefficient for z²)
#   D = E = F = G = H = I = 0
#   J = -1
#   Matrix form: diag(-1, -1, 1, -1)
#
# GEOMETRY:
#   - Two separate sheets (nappes)
#   - Upper apex: (0, 0, +c) = (0, 0, 1)
#   - Lower apex: (0, 0, -c) = (0, 0, -1)
#   - Gap between sheets: |z| < 1 (no surface exists here)
#   - Cross-sections parallel to XY: Circles with radius √(z² - 1)
#   - Cross-sections through Z-axis: Hyperbolas
#
# RADIUS AT HEIGHT z (for |z| ≥ 1):
#   r(z) = √(z² - 1)
#   At z=±1: r=0 (apex points)
#   At z=±1.25: r=0.75
#   At z=±1.5: r≈1.118
#   At z=±2: r≈1.732
#   At z=±2.5: r≈2.291
#
# COMPARISON WITH ONE-SHEET:
#   One Sheet: x² + y² - z² = 1 → continuous, ruled
#   Two Sheets: -x² - y² + z² = 1 → disconnected, not ruled
#   The sign change fundamentally alters the topology!
#
# PHYSICAL ANALOGIES:
#   - Shape of gravitational potential wells
#   - Electron orbitals in certain configurations
#   - Acoustic horn designs
#
# NORMAL CALCULATION:
#   Gradient of F(x,y,z) = -x² - y² + z² - 1:
#   ∇F = (-2x, -2y, 2z)
#   N = normalize(-x, -y, z) (points outward from both sheets)
#
# MESH STRUCTURE:
#   - Upper sheet: apex + 4 rings, 12 segments = 48 triangles × 2 = ~84 tri
#   - Lower sheet: mirror of upper = ~84 triangles
#   - Total: ~168 triangles
#   - Z range: ±1 to ±2.5
#
# OBJ FEATURES TESTED:
#   - Disconnected geometry (two separate meshes in one file)
#   - Apex/pole triangulation
#   - Variable ring radii
#   - Positive Gaussian curvature
#
# ============================================================================

mtllib ./quadric_materials.mtl

# Upper sheet (z >= 1)
# At z level, radius r = sqrt(z² - 1)

# z = 1.0, r = 0 (apex point)
v  0.000000  0.000000  1.000000

# z = 1.25, r = sqrt(0.5625) ≈ 0.75
v  0.750000  0.000000  1.250000
v  0.649519  0.375000  1.250000
v  0.375000  0.649519  1.250000
v  0.000000  0.750000  1.250000
v -0.375000  0.649519  1.250000
v -0.649519  0.375000  1.250000
v -0.750000  0.000000  1.250000
v -0.649519 -0.375000  1.250000
v -0.375000 -0.649519  1.250000
v  0.000000 -0.750000  1.250000
v  0.375000 -0.649519  1.250000
v  0.649519 -0.375000  1.250000

# z = 1.5, r = sqrt(1.25) ≈ 1.118
v  1.118034  0.000000  1.500000
v  0.968246  0.559017  1.500000
v  0.559017  0.968246  1.500000
v  0.000000  1.118034  1.500000
v -0.559017  0.968246  1.500000
v -0.968246  0.559017  1.500000
v -1.118034  0.000000  1.500000
v -0.968246 -0.559017  1.500000
v -0.559017 -0.968246  1.500000
v  0.000000 -1.118034  1.500000
v  0.559017 -0.968246  1.500000
v  0.968246 -0.559017  1.500000

# z = 2.0, r = sqrt(3) ≈ 1.732
v  1.732051  0.000000  2.000000
v  1.500000  0.866025  2.000000
v  0.866025  1.500000  2.000000
v  0.000000  1.732051  2.000000
v -0.866025  1.500000  2.000000
v -1.500000  0.866025  2.000000
v -1.732051  0.000000  2.000000
v -1.500000 -0.866025  2.000000
v -0.866025 -1.500000  2.000000
v  0.000000 -1.732051  2.000000
v  0.866025 -1.500000  2.000000
v  1.500000 -0.866025  2.000000

# z = 2.5, r = sqrt(5.25) ≈ 2.291
v  2.291288  0.000000  2.500000
v  1.984313  1.145644  2.500000
v  1.145644  1.984313  2.500000
v  0.000000  2.291288  2.500000
v -1.145644  1.984313  2.500000
v -1.984313  1.145644  2.500000
v -2.291288  0.000000  2.500000
v -1.984313 -1.145644  2.500000
v -1.145644 -1.984313  2.500000
v  0.000000 -2.291288  2.500000
v  1.145644 -1.984313  2.500000
v  1.984313 -1.145644  2.500000

# Lower sheet (z <= -1) - mirror of upper sheet

# z = -1.0, r = 0 (apex point)
v  0.000000  0.000000 -1.000000

# z = -1.25, r ≈ 0.75
v  0.750000  0.000000 -1.250000
v  0.649519  0.375000 -1.250000
v  0.375000  0.649519 -1.250000
v  0.000000  0.750000 -1.250000
v -0.375000  0.649519 -1.250000
v -0.649519  0.375000 -1.250000
v -0.750000  0.000000 -1.250000
v -0.649519 -0.375000 -1.250000
v -0.375000 -0.649519 -1.250000
v  0.000000 -0.750000 -1.250000
v  0.375000 -0.649519 -1.250000
v  0.649519 -0.375000 -1.250000

# z = -1.5, r ≈ 1.118
v  1.118034  0.000000 -1.500000
v  0.968246  0.559017 -1.500000
v  0.559017  0.968246 -1.500000
v  0.000000  1.118034 -1.500000
v -0.559017  0.968246 -1.500000
v -0.968246  0.559017 -1.500000
v -1.118034  0.000000 -1.500000
v -0.968246 -0.559017 -1.500000
v -0.559017 -0.968246 -1.500000
v  0.000000 -1.118034 -1.500000
v  0.559017 -0.968246 -1.500000
v  0.968246 -0.559017 -1.500000

# z = -2.0, r ≈ 1.732
v  1.732051  0.000000 -2.000000
v  1.500000  0.866025 -2.000000
v  0.866025  1.500000 -2.000000
v  0.000000  1.732051 -2.000000
v -0.866025  1.500000 -2.000000
v -1.500000  0.866025 -2.000000
v -1.732051  0.000000 -2.000000
v -1.500000 -0.866025 -2.000000
v -0.866025 -1.500000 -2.000000
v  0.000000 -1.732051 -2.000000
v  0.866025 -1.500000 -2.000000
v  1.500000 -0.866025 -2.000000

# z = -2.5, r ≈ 2.291
v  2.291288  0.000000 -2.500000
v  1.984313  1.145644 -2.500000
v  1.145644  1.984313 -2.500000
v  0.000000  2.291288 -2.500000
v -1.145644  1.984313 -2.500000
v -1.984313  1.145644 -2.500000
v -2.291288  0.000000 -2.500000
v -1.984313 -1.145644 -2.500000
v -1.145644 -1.984313 -2.500000
v  0.000000 -2.291288 -2.500000
v  1.145644 -1.984313 -2.500000
v  1.984313 -1.145644 -2.500000

usemtl emissive_warm

# Upper sheet faces

# Apex to first ring
f 1 2 3
f 1 3 4
f 1 4 5
f 1 5 6
f 1 6 7
f 1 7 8
f 1 8 9
f 1 9 10
f 1 10 11
f 1 11 12
f 1 12 13
f 1 13 2

# Ring 1 to ring 2
f 2 14 15
f 2 15 3
f 3 15 16
f 3 16 4
f 4 16 17
f 4 17 5
f 5 17 18
f 5 18 6
f 6 18 19
f 6 19 7
f 7 19 20
f 7 20 8
f 8 20 21
f 8 21 9
f 9 21 22
f 9 22 10
f 10 22 23
f 10 23 11
f 11 23 24
f 11 24 12
f 12 24 25
f 12 25 13
f 13 25 14
f 13 14 2

# Ring 2 to ring 3
f 14 26 27
f 14 27 15
f 15 27 28
f 15 28 16
f 16 28 29
f 16 29 17
f 17 29 30
f 17 30 18
f 18 30 31
f 18 31 19
f 19 31 32
f 19 32 20
f 20 32 33
f 20 33 21
f 21 33 34
f 21 34 22
f 22 34 35
f 22 35 23
f 23 35 36
f 23 36 24
f 24 36 37
f 24 37 25
f 25 37 26
f 25 26 14

# Ring 3 to ring 4
f 26 38 39
f 26 39 27
f 27 39 40
f 27 40 28
f 28 40 41
f 28 41 29
f 29 41 42
f 29 42 30
f 30 42 43
f 30 43 31
f 31 43 44
f 31 44 32
f 32 44 45
f 32 45 33
f 33 45 46
f 33 46 34
f 34 46 47
f 34 47 35
f 35 47 48
f 35 48 36
f 36 48 49
f 36 49 37
f 37 49 38
f 37 38 26

# Lower sheet faces

# Apex to first ring (vertex 50 is lower apex)
f 50 52 51
f 50 53 52
f 50 54 53
f 50 55 54
f 50 56 55
f 50 57 56
f 50 58 57
f 50 59 58
f 50 60 59
f 50 61 60
f 50 62 61
f 50 51 62

# Ring 1 to ring 2
f 51 64 63
f 51 52 64
f 52 65 64
f 52 53 65
f 53 66 65
f 53 54 66
f 54 67 66
f 54 55 67
f 55 68 67
f 55 56 68
f 56 69 68
f 56 57 69
f 57 70 69
f 57 58 70
f 58 71 70
f 58 59 71
f 59 72 71
f 59 60 72
f 60 73 72
f 60 61 73
f 61 74 73
f 61 62 74
f 62 63 74
f 62 51 63

# Ring 2 to ring 3
f 63 76 75
f 63 64 76
f 64 77 76
f 64 65 77
f 65 78 77
f 65 66 78
f 66 79 78
f 66 67 79
f 67 80 79
f 67 68 80
f 68 81 80
f 68 69 81
f 69 82 81
f 69 70 82
f 70 83 82
f 70 71 83
f 71 84 83
f 71 72 84
f 72 85 84
f 72 73 85
f 73 86 85
f 73 74 86
f 74 75 86
f 74 63 75

# Ring 3 to ring 4
f 75 88 87
f 75 76 88
f 76 89 88
f 76 77 89
f 77 90 89
f 77 78 90
f 78 91 90
f 78 79 91
f 79 92 91
f 79 80 92
f 80 93 92
f 80 81 93
f 81 94 93
f 81 82 94
f 82 95 94
f 82 83 95
f 83 96 95
f 83 84 96
f 84 97 96
f 84 85 97
f 85 98 97
f 85 86 98
f 86 87 98
f 86 75 87

